<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Zhirui's Lab | Bayesian phylogenetics</title>
<meta name="description" content="">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.xyz/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ”¥</text></svg>">

<link rel="stylesheet" href="/zhirui_lab/assets/css/main.css">

<link rel="canonical" href="/zhirui_lab/projects/1_project/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

  <script src="/zhirui_lab/assets/js/theme.js"></script>
  <!-- Load DarkMode JS -->
<script src="/zhirui_lab/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/zhirui_lab/">
       Zhirui's Lab
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/zhirui_lab/">
              about
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/zhirui_lab/publications/">
                publications
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/zhirui_lab/projects/">
                research
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/zhirui_lab/softwares/">
                softwares
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/zhirui_lab/teaching/">
                teaching
                
              </a>
          </li>
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">Bayesian phylogenetics</h1>
    <p class="post-description">Bayesian methods for detecting convergence on phylogenetic tree</p>
  </header>

  <article>
    <div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/zhirui_lab/assets/img/3.jpg" alt="" title="Phenotypic convergence" />
    </div>
</div>
<div class="caption">
    Phenotypic convergence in birds, reptiles and mammals.
</div>

<p>The conversation of DNA sequence indicates its important biological function. The gain and loss of conservation in some species can infer the function changes in evolutionary history. When the genomic region is conversed, its sequence has few substitutions to maintain the function; otherwise, its sequence accumulates substitutions when the function is lost. Phenotypic convergence, in which the same function or morphology evolves multiple times independently, often due to adaption to similar environmental changes, is generally believed to be a strong signature of natural selection. However, we generally do not have a robust understanding of the genomic changes underlying phenotypic convergence. A key question in evolutionary biology is that whether convergent phenotypes arise from repeated use of the same underlying genetic elements, or via independent genetic pathways. The increasing amount of whole genome sequencing and phenotypic data in various species facilitates the study of molecular basis underlying species evolution. However, it also requires sophisticated statistical modeling and efficient statistical computing methods.</p>

<p>Convergence at the molecular level can arise via consistent shifts in substitution rate in genomic regions influencing particular phenotypic targets of natural selection. On a phylogenetic tree, the change of substitution rate on some branches can be used to detect the genomic regions that are associated with phenotypic convergence. However, existing methods do not allow easy detection of patterns of rate variation, which causes challenges for detecting convergent rate shifts or other complex evolutionary scenarios. Here we introduce PhyloAcc, a new Bayesian method to model substitution rate changes in conserved elements across a phylogeny. Compared with previous methods testing a predefined evolutionary history, PhyloAcc can distinguish different patterns of substitution rate changes. The method assumes several categories of substitution rate for each branch on the phylogenetic tree, estimates substitution rates per category, and detects changes of substitution rate as the posterior probability of a category switch. It uses Markov Chain Monte Carlo methods (MCMC) to estimate substitution rate shifts on the phylogeny, and computes Bayes factors for detecting genomic regions where rate shifts parallel with phenotype changes.</p>

<p>In two classic examples of convergent phenotypes, loss of flight in birds and the transition to marine life in mammals, our approach reveals numerous examples of conserved non-exonic elements with accelerations specific to the phenotypically convergent lineages. In the bird examples, we combined phylogenomic, developmental, and epigenomic analysis of 11 new genomes of paleognathous birds, including an extinct moa, to show that convergent evolution of regulatory regions, more so than protein-coding genes, is prevalent among developmental pathways associated with independent losses of flight. A Bayesian analysis of 284,001 conserved noncoding elements, 60,665 of which are corroborated as enhancers by open chromatin states during development, identified 2355 independent accelerations along lineages of flightless paleognaths, with functional consequences for driving gene expression in the developing forelimb. Our results suggest that the genomic landscape associated with morphological convergence in ratites has a substantial shared regulatory component. Our method is widely applicable to any set of conserved elements where multiple rate changes are expected on a phylogeny.</p>

<p>Another major issue not addressed by previous model is the possible heterogeneity in the gene trees across the genome. We later proposed PhyloAcc-GT, combining multispecies coalescent model with PhyloAcc framework to test the correlation between rate shifts and phenotypes per genomic region, accounting for phylogenetic uncertainty. PhyloAcc-GT uses MCMC to sample from the gene tree space, sums the likelihood over all probable gene trees given a species tree under the multispecies coalescent model, then compares the marginal likelihood under different hypotheses to identify genomic regions underlying phenotypic convergence. As the model becomes more complicated, it challenges current computational methods for statistical inference. We also improved several statistical computing methods, e.g., design more efficient proposal distribution for sampling gene trees and develop better methods for computing Bayes factor, which are critical problems in Bayesian statistics.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/zhirui_lab/assets/img/1.jpg" alt="" title="PhyloAcc results for ratites" />
    </div>
</div>
<div class="caption">
    PhyloAcc is applied on bird phylogeny and it identifies CNEEs associated with loss of flight in ratites. 
</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/zhirui_lab/assets/img/2.jpg" alt="" title="PhyloAcc results for mammals" />
    </div>
</div>
<div class="caption">
    PhyloAcc identifies CNEEs associated with phenotype changes in marine mammals. The functions of these CNEEs enrich in morphological traits and nervous, immune systems. 
</div>

<h1 id="references">References</h1>
<ul>
  <li>
    <p>Zhirui Hu, Timothy B. Sackton, Scott V. Edwards, Jun S. Liu. Bayesian detection of convergent rate changes of conserved noncoding elements on phylogenetic trees. Molecular Biology and Evolution. 2019 36(5): 1086â€“1100. <a href="https://academic.oup.com/mbe/article/36/5/1086/5372678">Link</a></p>
  </li>
  <li>
    <p>Timothy B. Sackton, Phil Grayson, Alison Cloutier, Zhirui Hu, Jun S. Liu, Nicole E. Wheeler, Paul P. Gardner, Julia A. Clarke, Allan J. Baker, Michele Clamp, Scott V. Edwards. Convergent regulatory evolution and loss of flight in palaeognathous birds. Science 2019 364(6435):74-78. <a href="https://science.sciencemag.org/content/364/6435/74">Link</a></p>
  </li>
  <li>
    <p><a href="https://github.com/xyz111131/PhyloAcc">PhyloAcc</a>: a software to detect the changes of conservation of a genomic region. C/C++</p>
  </li>
</ul>

<!---
<div class="row justify-content-sm-center">
    <div class="col-sm-8 mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/zhirui_lab/assets/img/6.jpg" alt="" title="example image"/>
    </div>
    <div class="col-sm-4 mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/zhirui_lab/assets/img/11.jpg" alt="" title="example image"/>
    </div>
</div>
<div class="caption">
    You can also have artistically styled 2/3 + 1/3 images, like these.
</div>



The code is simple.
Just wrap your images with `<div class="col-sm">` and place them inside `<div class="row">` (read more about the <a href="https://getbootstrap.com/docs/4.4/layout/grid/" target="_blank">Bootstrap Grid</a> system).
To make images responsive, add `img-fluid` class to each; for rounded corners and shadows use `rounded` and `z-depth-1` classes.
Here's the code for the last row of images above:

```html
<div class="row justify-content-sm-center">
    <div class="col-sm-8 mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/zhirui_lab/assets/img/6.jpg" alt="" title="example image"/>
    </div>
    <div class="col-sm-4 mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/zhirui_lab/assets/img/11.jpg" alt="" title="example image"/>
    </div>
</div>
```

-->

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2022 Zhirui  Hu.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/zhirui_lab/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Load Common JS -->
<script src="/zhirui_lab/assets/js/common.js"></script>


</html>
